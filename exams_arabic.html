<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>اختبار نحو الصف الأول الإعدادي</title>
  <!-- خطوط -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Reem+Kufi&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #FFF8E7;
      --card: #FFFFFF;
      --primary: #8B4513;
      --secondary: #F5DEB3;
      --accent: #CD853F;
      --text: #3D2314;
      --border: #CD853F;
      --radius: 12px;
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      font-family:'Amiri', serif;
      background: var(--bg);
      color: var(--text);
      display:flex; flex-direction:column; align-items:center;
      padding:1rem;
    }
    header {
      width:100%; display:flex; justify-content:space-between; align-items:center;
      background: var(--primary); padding:.8rem; border-radius:var(--radius);
      margin-bottom:1rem;
    }
    header h1 {
      font-family:'Reem Kufi',sans-serif; color:#fff; font-size:1.4rem;
    }
    header a.home {
      color:#fff; font-size:1.5rem; text-decoration:none;
    }
    .levels {
      display:flex; width:100%; margin-bottom:1rem;
    }
    .levels button {
      flex:1; padding:.6rem; border:none;
      background:var(--secondary);
      font-family:'Reem Kufi'; font-size:1rem;
      cursor:pointer; transition:background .3s;
      border-right:2px solid var(--accent);
    }
    .levels button:last-child { border-right:none; }
    .levels button.active {
      background:var(--accent); color:#fff;
    }
    .controls {
      width:100%; max-width:480px;
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:1rem; font-family:'Reem Kufi';
    }
    .controls button {
      background:var(--accent); color:#fff; border:none;
      padding:.5rem 1rem; border-radius:var(--radius); cursor:pointer;
      font-family:'Reem Kufi';
    }
    #timer {
      font-family:'Reem Kufi'; font-size:1rem;
      background:var(--secondary); padding:.4rem .8rem;
      border-radius:var(--radius);
    }
    #quiz { width:100%; max-width:480px; }
    .card {
      background:var(--card); border:2px solid var(--border);
      border-radius:var(--radius); padding:1rem; margin-bottom:1rem;
      box-shadow:2px 2px 6px rgba(0,0,0,0.1);
    }
    .card h4 {
      font-family:'Reem Kufi'; margin-bottom:.5rem;
      background:var(--secondary); padding:.4rem .6rem;
      border-radius:var(--radius);
      font-size:1rem;
    }
    .card p {
      margin-bottom:.6rem; line-height:1.4;
    }
    .card ul { list-style:none; }
    .card li { margin:.4rem 0; }
    .card button {
      width:100%; padding:.5rem; text-align:right;
      background:var(--bg); border:1px solid var(--border);
      border-radius:var(--radius); cursor:pointer;
      transition:background .2s;
      font-family:'Amiri';
    }
    .card button:hover { background:#f0e6d6; }
    .feedback {
      margin-top:.5rem; font-weight:bold;
      font-family:'Amiri';
    }
    #scorePanel, #statsPanel {
      width:100%; max-width:480px; background:var(--secondary);
      border-radius:var(--radius); padding:1rem; margin-top:1rem;
      font-family:'Reem Kufi';
    }
    #statsPanel { background:var(--card); }
    #statsPanel h3 {
      margin-bottom:.5rem; font-family:'Reem Kufi';
    }
    #statsPanel ul { list-style:none; }
    #statsPanel li { margin:.4rem 0; }
    #retry {
      margin-top:.6rem; background:var(--primary);
      color:#fff; border:none; padding:.5rem 1rem;
      border-radius:var(--radius); cursor:pointer;
      font-family:'Reem Kufi';
    }
    @media(max-width:480px){
      header h1 { font-size:1.2rem; }
      .levels button { font-size:.9rem; padding:.5rem; }
    }
  </style>
</head>
<body>

  <header>
    <a href="main.html" class="home">🏠</a>
    <h1>اختبار نحو أولي إعدادي</h1>
    <div style="width:1.5rem"></div>
  </header>

  <div class="levels">
    <button data-l="1" class="active">المستوى 1</button>
    <button data-l="2">المستوى 2</button>
    <button data-l="3">المستوى 3</button>
    <button data-l="4">المستوى 4</button>
  </div>

  <div class="controls">
    <div id="timer">00:30:00</div>
    <button id="toggleTimer">أوقف/ابدأ المؤقت</button>
  </div>

  <div id="quiz"></div>

  <div id="scorePanel" style="display:none;">
    نتيجتك في هذا المستوى: <span id="scoreVal"></span><br>
    <button id="retry">إعادة الاختبار</button>
  </div>

  <div id="statsPanel" style="display:none;">
    <h3>إحصائيات درجاتك</h3>
    <ul id="statsList"></ul>
  </div>

  <script>
    const data = {
      1: [
        {
          q: "في الجملة: «ذهبَ الولدُ الصغيرُ إلى المدرسةِ». ما النعت؟",
          c: ["الولدُ","الصغيرُ","المدرسةِ","ذهبَ"],
          a:1,
          e: "«الصغير» نعت لأنه صفة تالية لكلمة «الولد» تتبعها في الإعراب."
        },
        {
          q: "في الجملة: «أكَلَ الولدُ التفاحةَ»، هذه جملة فعلية مبنية للمعلوم أم للمجهول؟",
          c: ["للمعلوم","للمجهول"],
          a:0,
          e: "الفعل «أكَلَ» ذُكر معه فاعله، لذا هو مبني للمعلوم."
        },
        {
          q: "في الجملة: «كُتِبَ الدرسُ على السبورةِ»، مبنية للمعلوم أم المجهول؟",
          c: ["للمعلوم","للمجهول"],
          a:1,
          e: "«كُتِبَ» بدون فاعل مذكور، فهي مبنية للمجهول."
        },
        {
          q: "في المبني للمجهول: «ضُرِبَ الولدُ»، ما نائب الفاعل؟",
          c: ["ضُرِبَ","الولدُ","لا يوجد","لفظ (ضرب)"],
          a:1,
          e: "«الولدُ» نائب الفاعل مرفوع، لأنه حل محل الفاعل المحذوف."
        },
        {
          q: "أيّ من الكلمات التالية تبدأ بهمزة وصل؟",
          c: ["ابن","إنشاء","اتصال","إسلام"],
          a:0,
          e: "«ابن» تبدأ بألف وصل ولا تُلفظ عند الوصل."
        },
        {
          q: "في الجملة: «ألبَسَ الأبُ ابنهُ ثوبًا»، كم مفعول؟",
          c: ["واحد","مطلق","مفعولان","لا يوجد"],
          a:2,
          e: "«ألبس» متعدٍّ إلى مفعولين: «ابنه» و«ثوبًا»."
        }
      ],
      2: [
        {
          q: "أي من الأفعال التالية ينصب مفعولين ليس أصلهما مبتدأ وخبر؟",
          c: ["ظنَّ","أعطى","شربَ","رجعَ"],
          a:1,
          e: "«أعطى» تنصب مفعولين وليست مبتدأ وخبر."
        },
        {
          q: "في الجملة: «زار الولدُ رجلًا عجوزًا»، ما النعت؟",
          c: ["الولدُ","رجلًا","عجوزًا","زار"],
          a:2,
          e: "«عجوزًا» نعت تابع لـ«رجل» في الإعراب."
        },
        {
          q: "في الجملة: «أعطى المعلمُ الطلابَ كتبًا»، ما المفعول به الأول؟",
          c: ["المعلمُ","الطلابَ","كتبًا","لا يوجد"],
          a:1,
          e: "«الطلابَ» هو المفعول به الأول."
        },
        {
          q: "حوّل: «أنقذَ الصيادُ الغريقَ» إلى مبني للمجهول.",
          c: ["أُنقِذَ الغريقُ","أُنقِذَ الصيادُ","أُنقِذَ الغريقُ بواسطة الصيادِ","الغريقُ أُنقِذَ"],
          a:0,
          e: "تصبح «أُنقِذَ الغريقُ» مع رفع «الغريق» نائب فاعل."
        },
        {
          q: "في المجهول: «أُكِلَ الطعامُ»، ما نائب الفاعل؟",
          c: ["الطعامُ","أُكِلَ","لا يوجد","وجبة"],
          a:0,
          e: "«الطعامُ» نائب الفاعل مرفوع."
        },
        {
          q: "كيف تُكتب همزة «مؤمن»؟",
          c: ["على الألف","على الواو","على الياء","لا تكتب"],
          a:1,
          e: "الهمزة متوسطة والضمة قبلها، فتُكتب على الواو."
        },
        {
          q: "كيف تُكتب همزة «سماء»؟",
          c: ["على الألف","على الواو","على الياء","على السطر"],
          a:3,
          e: "همزة متطرفة سبقها حرف مضموم، فتُكتب على السطر."
        }
      ],
      3: [
        {
          q: "في الجملة: «اشتريت كتابًا كبيرًا جديدًا»، نوع «جديدًا»؟",
          c: ["نعت","بدل","حال","مفعول مطلق"],
          a:0,
          e: "«جديدًا» نعت مفرد تابع لـ«كتاب»."
        },
        {
          q: "في: «سأل المديرُ زميلَه سؤالًا صعبًا»، المفعول به الثاني؟",
          c: ["المديرُ","زميلَه","سؤالًا","صعبًا"],
          a:2,
          e: "«سؤالًا» مفعول ثانٍ."
        },
        {
          q: "حوّل: «قطعَ العاملُ الخيطَ» إلى مبني للمجهول.",
          c: ["قُطِعَ الخيطُ","قُطِعَ العاملُ","بواسطة العاملِ","الخيطُ قُطِعَ"],
          a:0,
          e: "تصبح «قُطِعَ الخيطُ» مع رفع «الخيط» نائب فاعل."
        },
        {
          q: "في المجهول: «سُرِقَ المالُ»، ما نائب الفاعل؟",
          c: ["السرقةُ","المالُ","لا يوجد","اللصُّ"],
          a:1,
          e: "«المالُ» نائب الفاعل مرفوع."
        },
        {
          q: "أي كلمة بها همزة متوسطة؟",
          c: ["يسألُ","شؤونُ","قرآنُ","مؤامرة"],
          a:0,
          e: "همزة في وسط «يسألُ» فتسمى متوسطة."
        },
        {
          q: "كيف تُكتب همزة «ملء»؟",
          c: ["على الألف","على الواو","على الياء","على السطر"],
          a:3,
          e: "همزة متطرفة سبقها لام ساكنة، فتُكتب على السطر."
        },
        {
          q: "أي فعل يُبنى للمجهول؟",
          c: ["جلسَ","قطعَ","نامَ","بكى"],
          a:1,
          e: "«قطعَ» متعدٍّ، فيبنى للمجهول."
        },
        {
          q: "ما النعت في: «وصل المهندس المصري إلى المكانِ آمنًا»؟",
          c: ["المهندسُ","المصري","آمنًا","وصل"],
          a:2,
          e: "«آمنًا» حال تابعة لـ«وصل». "
        }
      ],
      4: [
        {
          q: "حكم «واحدًا» في: «لبستُ ثوبًا أنيقًا واحدًا»؟",
          c: ["نعت","عدد تمييزي","بدل","مفعول به"],
          a:1,
          e: "عدد تمييزي يميز «ثوبًا». "
        },
        {
          q: "حكم «مسرعةً» في: «عادت الفتاةُ...مسرعةً»؟",
          c: ["نعت","حال","مفعول ثانٍ","ظرف"],
          a:1,
          e: "«مسرعةً» حال لمنعوت الفعل."
        },
        {
          q: "في: «وجدتُ الضابطَ صديقًا صالحًا»، ما المنعوت؟",
          c: ["الضابطَ","صديقًا","صالحًا","الضابطَ وصالحًا"],
          a:0,
          e: "«الضابطَ» المفعول به الأول."
        },
        {
          q: "في «أُرسِلَت الرسائلُ»، نائب الفاعل؟",
          c: ["الرسائلُ","أُرسلت","لا يوجد","الحروف"],
          a:0,
          e: "«الرسائلُ» نائب الفاعل."
        },
        {
          q: "أي كلمة تبدأ بهمزة قطع؟",
          c: ["ابن","استئناف","إنشاء","اتصال"],
          a:2,
          e: "«إنشاء» بهمزة قطع تُكتب وتُلفظ."
        },
        {
          q: "همزة «يساؤلون» تُكتب؟",
          c: ["على الألف","على الواو","على الياء","على السطر"],
          a:2,
          e: "همزة متوسطة والكسر قبلها، فتُكتب على الياء."
        },
        {
          q: "همزة «استيعاب» تُكتب؟",
          c: ["على الألف","على الواو","على الياء","على السطر"],
          a:0,
          e: "همزة وصل تُكتب ألفًا دون رمز."
        },
        {
          q: "حكم «الوارفةَ» في: «رأيت الشجرةَ الوارفةَ»؟",
          c: ["نعت","حال","مفعول مطلق","بدل"],
          a:0,
          e: "«الوارفةَ» نعت مفرد."
        },
        {
          q: "حكم «مبسطًا» و«مُفيدًا» في: «اشتريت كتابًا مبسطًا مُفيدًا»؟",
          c: ["نعت ونعت","بدل،حال","مفعول مطلق","حال،بدل"],
          a:0,
          e: "كلاهما نعت مفرد تابع للمنعوت."
        }
      ]
    };
    let level=1, total=0, correct=0, timeLeft=1800, timerOn=false, timerInt;
    const quizEl=document.getElementById('quiz'),
          timerEl=document.getElementById('timer'),
          toggleBtn=document.getElementById('toggleTimer'),
          scoreEl=document.getElementById('scorePanel'),
          scoreVal=document.getElementById('scoreVal'),
          retryBtn=document.getElementById('retry'),
          statsEl=document.getElementById('statsPanel'),
          statsList=document.getElementById('statsList');

    const stats = {1:null,2:null,3:null,4:null};

    function startLevel(l){
      clearInterval(timerInt);
      level=l; total=data[l].length; correct=0;
      scoreEl.style.display='none';
      quizEl.innerHTML='';
      timeLeft=1800; updateTimerDisplay();
      if(timerOn) timerInt=setInterval(tick,1000);

      data[l].forEach((o,i)=>{
        const card=document.createElement('div');
        card.className='card';
        card.innerHTML=`
          <h4>س${i+1}</h4>
          <p>${o.q}</p>
          <ul>${o.c.map((ch,j)=>
            `<li><button data-i="${i}" data-j="${j}">${String.fromCharCode(65+j)}. ${ch}</button></li>`
          ).join('')}</ul>
          <div class="feedback" id="fb${i}"></div>`;
        quizEl.appendChild(card);
      });

      quizEl.querySelectorAll('button').forEach(b=>{
        b.onclick=()=> {
          const i=+b.dataset.i, j=+b.dataset.j, fb=document.getElementById('fb'+i);
          if(fb.textContent) return;
          if(j===data[level][i].a){
            fb.textContent='تمام! صح كده.'; fb.style.color='green'; correct++;
          } else {
            const ans=data[level][i].c[data[level][i].a];
            fb.innerHTML=`لأ يا باشا، دي غلط.<br>الصح: ${ans}<br>${data[level][i].e}`;
            fb.style.color='red';
          }
          if([...quizEl.querySelectorAll('.feedback')].every(f=>f.textContent)){
            finishLevel();
          }
        };
      });
    }

    function finishLevel(){
      clearInterval(timerInt);
      scoreVal.textContent=`${correct}/${total}`;
      scoreEl.style.display='block';
      stats[level]=`${correct}/${total}`;
      renderStats();
    }

    function renderStats(){
      statsEl.style.display='block';
      statsList.innerHTML = Object.keys(stats).map(l=>
        `<li>المستوى ${l}: ${stats[l]||'-'}</li>`
      ).join('');
    }

    function tick(){
      if(timeLeft<=0){
        clearInterval(timerInt);
        alert('انتهى الوقت! فشلت في هذا المستوى.');
        finishLevel();
      } else {
        timeLeft--;
        updateTimerDisplay();
      }
    }

    function updateTimerDisplay(){
      const h=String(Math.floor(timeLeft/3600)).padStart(2,'0'),
            m=String(Math.floor((timeLeft%3600)/60)).padStart(2,'0'),
            s=String(timeLeft%60).padStart(2,'0');
      timerEl.textContent=`${h}:${m}:${s}`;
    }

    toggleBtn.onclick=()=>{
      timerOn = !timerOn;
      if(timerOn) timerInt=setInterval(tick,1000);
      else clearInterval(timerInt);
    };
    retryBtn.onclick=()=> startLevel(level);

    document.querySelectorAll('.levels button').forEach(btn=>{
      btn.onclick=()=>{
        document.querySelector('.levels .active').classList.remove('active');
        btn.classList.add('active');
        startLevel(+btn.dataset.l);
      };
    });

    // ابدأ المستوى 1
    startLevel(1);
  </script>
</body>
</html>
